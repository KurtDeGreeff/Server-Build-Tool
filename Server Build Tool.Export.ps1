#------------------------------------------------------------------------
# Source File Information (DO NOT MODIFY)
# Source ID: 8f4b17fd-6bec-4c13-af68-0833e8acf446
# Source File: Server Build Tool.psf
#------------------------------------------------------------------------
#region File Recovery Data (DO NOT MODIFY)
<#RecoveryData:
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
KyP1/wEzmrPwdEQAAA==#>
#endregion

Function Write-RichText{
	<#
	.SYNOPSIS
		A function to output text to a Rich Text Box.
	
	.DESCRIPTION
		This function appends text to a Rich Text Box and colors it based 
        upon the type of message being displayed.

    .PARAM Logtype
        Used to determine if the text is a success or error message or purely
        informational.

    .PARAM LogMSG
        The message to be added to the RichTextBox.
	
	.EXAMPLE
		Write-Richtext -LogType Error -LogMsg "This is an Error."
		Write-Richtext -LogType Success -LogMsg "This is a Success."
		Write-Richtext -LogType Informational -LogMsg "This is Informational."
	
	.NOTES
		N/A
#>
	
	Param
	(
		[Parameter(Mandatory = $true, Position = 0, ValueFromPipeline, ValueFromPipelineByPropertyName)]
		[String]$LogType,
		[Parameter(Mandatory = $true, Position = 1, ValueFromPipeline, ValueFromPipelineByPropertyName)]
		[String]$LogMsg,
		[Parameter(Mandatory = $true, Position = 2, ValueFromPipeline, ValueFromPipelineByPropertyName)]
		[System.Windows.Forms.RichTextBox]$RTB
	)
	
	switch ($logtype)
	{
		Error {
			$RTB.SelectionColor = 'Red'
			$RTB.AppendText("`n $logtype : $logmsg")
			
		}
		Success {
			$RTB.SelectionColor = 'Green'
			$RTB.AppendText("`n $logmsg")
			
		}
		Informational {
			$RTB.SelectionColor = 'Blue'
			$RTB.AppendText("`n $logmsg")
			
		}
		
	}
	
}

Function Validate-WizardPage{
	
	[OutputType([boolean])]
	param
	(
		[System.Windows.Forms.TabPage]$tabPage
	)
	
	switch ($tabPage)
	{
		#If its the welcome page it should always enable the next button.
		$WelcomeStep
		{
			$Buttonsettings = New-Object PSObject -Property @{
				back = $False
				next = $True
				cancel = $true
				finish = $False
			}
			
			return $Buttonsettings
		}
		
		$VCenterStep
		{
			if ($VCenterComboBox.SelectedItem)
			{
				write-richtext -LogType 'informational' `
							   -logmsg "Attempting to connect to $($VCenterComboBox.SelectedItem)" `
							   -RTB $VcenterLoggingbox
				
				$Connection = (Connect-VIServer -Server $VCenterComboBox.SelectedItem | Out-Null)
				
				if ($Connection)
				{
					$Buttonsettings = New-Object PSObject -Property @{
						back = $True
						next = $True
						cancel = $true
						finish = $False
					}
					write-richtext -LogType 'success' `
								   -logmsg "A connection has been made to $($VCenterComboBox.SelectedItem)" `
								   -RTB $VcenterLoggingbox
					
					Update-TemplateDGV
					return $Buttonsettings
				}
				
				else
				{
					$Buttonsettings = New-Object PSObject -Property @{
						back = $True
						next = $False
						cancel = $true
						finish = $False
					}
					write-richtext -LogType 'success' `
								   -logmsg "A connection has been made to $($VCenterComboBox.SelectedItem)" `
								   -RTB $VcenterLoggingbox
					
					return $Buttonsettings
				}
			}
			else
			{
				write-richtext -LogType 'informational' `
							   -logmsg "Please select a VCenter Server from the Dropdown" `
							   -RTB $VcenterLoggingbox
				
				$Buttonsettings = New-Object PSObject -Property @{
					back = $True
					next = $False
					cancel = $true
					finish = $False
				}
				
				return $Buttonsettings
			}
		}
		
		$TemplateStep
		{
			'do stuff'
		}
		
		default
		{
			return $false
		}
		
	}
}

function Update-NavButtons{
	$ButtonSettings = Validate-WizardPage $tabcontrolWizard.SelectedTab
	
	$buttonNext.Enabled = $($ButtonSettings.next)
	$buttonBack.Enabled = $($ButtonSettings.back)
	$buttonFinish.Enabled = $($ButtonSettings.finish)
	$buttonCancel.Enabled = $($ButtonSettings.cancel)
}

function Update-TemplateDGV{
	[Array]$griddata = Get-Template -Server $($VCenterComboBox.SelectedItem)
	$Table = ConvertTo-DataTable -InputObject $griddata
	Load-DataGridView -DataGridView $TemplateDGV -Item $Table -DataMember 'Templates'
}

function Load-DataGridView{
		<#
		.SYNOPSIS
			This functions helps you load items into a DataGridView.
	
		.DESCRIPTION
			Use this function to dynamically load items into the DataGridView control.
	
		.PARAMETER  DataGridView
			The DataGridView control you want to add items to.
	
		.PARAMETER  Item
			The object or objects you wish to load into the DataGridView's items collection.
		
		.PARAMETER  DataMember
			Sets the name of the list or table in the data source for which the DataGridView is displaying data.
	
		#>
	Param (
		[ValidateNotNull()]
		[Parameter(Mandatory = $true)]
		[System.Windows.Forms.DataGridView]$DataGridView,
		[ValidateNotNull()]
		[Parameter(Mandatory = $true)]
		$Item,
		[Parameter(Mandatory = $false)]
		[string]$DataMember
	)
	$DataGridView.SuspendLayout()
	$DataGridView.DataMember = $DataMember
	
	if ($Item -is [System.ComponentModel.IListSource]`
	-or $Item -is [System.ComponentModel.IBindingList] -or $Item -is [System.ComponentModel.IBindingListView])
	{
		$DataGridView.DataSource = $Item
	}
	else
	{
		$array = New-Object System.Collections.ArrayList
		
		if ($Item -is [System.Collections.IList])
		{
			$array.AddRange($Item)
		}
		else
		{
			$array.Add($Item)
		}
		$DataGridView.DataSource = $array
	}
	
	$DataGridView.ResumeLayout()
}

function ConvertTo-DataTable{
		<#
			.SYNOPSIS
				Converts objects into a DataTable.
		
			.DESCRIPTION
				Converts objects into a DataTable, which are used for DataBinding.
		
			.PARAMETER  InputObject
				The input to convert into a DataTable.
		
			.PARAMETER  Table
				The DataTable you wish to load the input into.
		
			.PARAMETER RetainColumns
				This switch tells the function to keep the DataTable's existing columns.
			
			.PARAMETER FilterWMIProperties
				This switch removes WMI properties that start with an underline.
		
			.EXAMPLE
				$DataTable = ConvertTo-DataTable -InputObject (Get-Process)
		#>
	[OutputType([System.Data.DataTable])]
	param (
		[ValidateNotNull()]
		$InputObject,
		[ValidateNotNull()]
		[System.Data.DataTable]$Table,
		[switch]$RetainColumns,
		[switch]$FilterWMIProperties)
	
	if ($Table -eq $null)
	{
		$Table = New-Object System.Data.DataTable
	}
	
	if ($InputObject -is [System.Data.DataTable])
	{
		$Table = $InputObject
	}
	else
	{
		if (-not $RetainColumns -or $Table.Columns.Count -eq 0)
		{
			#Clear out the Table Contents
			$Table.Clear()
			
			if ($InputObject -eq $null) { return } #Empty Data
			
			$object = $null
			#find the first non null value
			foreach ($item in $InputObject)
			{
				if ($item -ne $null)
				{
					$object = $item
					break
				}
			}
			
			if ($object -eq $null) { return } #All null then empty
			
			#Get all the properties in order to create the columns
			foreach ($prop in $object.PSObject.Get_Properties())
			{
				if (-not $FilterWMIProperties -or -not $prop.Name.StartsWith('__')) #filter out WMI properties

				{
					#Get the type from the Definition string
					$type = $null
					
					if ($prop.Value -ne $null)
					{
						try { $type = $prop.Value.GetType() }
						catch { }
					}
					
					if ($type -ne $null) # -and [System.Type]::GetTypeCode($type) -ne 'Object')

					{
						[void]$table.Columns.Add($prop.Name, $type)
					}
					else #Type info not found

					{
						[void]$table.Columns.Add($prop.Name)
					}
				}
			}
			
			if ($object -is [System.Data.DataRow])
			{
				foreach ($item in $InputObject)
				{
					$Table.Rows.Add($item)
				}
				return @( ,$Table)
			}
		}
		else
		{
			$Table.Rows.Clear()
		}
		
		foreach ($item in $InputObject)
		{
			$row = $table.NewRow()
			
			if ($item)
			{
				foreach ($prop in $item.PSObject.Get_Properties())
				{
					if ($table.Columns.Contains($prop.Name))
					{
						$row.Item($prop.Name) = $prop.Value
					}
				}
			}
			[void]$table.Rows.Add($row)
		}
	}
	
	return @( ,$Table)
}

Function Build-Form {

	#region Import Assemblies and Modules

	Add-Type -AssemblyName System.Windows.Forms
	Add-Type -AssemblyName System.Data
	Add-Type -AssemblyName System.Drawing
	Import-Module -Name VMware.VimAutomation.Core
	#Set-PowerCLIConfiguration -InvalidCertificateAction Ignore -confirm
	
	#endregion

	#region Declare Form Objects

	[System.Windows.Forms.Application]::EnableVisualStyles()
	
	#Form Wide Controls
	$formWizard = New-Object 'System.Windows.Forms.Form'
		$buttonCancel = New-Object 'System.Windows.Forms.Button'
		$buttonBack = New-Object 'System.Windows.Forms.Button'
		$buttonNext = New-Object 'System.Windows.Forms.Button'
		$buttonFinish = New-Object 'System.Windows.Forms.Button'
		$tabcontrolWizard = New-Object 'System.Windows.Forms.TabControl'
	
	#Step 1
	$WelcomeStep = New-Object 'System.Windows.Forms.TabPage'
		$WelcomeTextBox = New-Object 'System.Windows.Forms.TextBox'
	
	#Step 2
	$VCenterStep = New-Object 'System.Windows.Forms.TabPage'
		$VCenterComboBox = New-Object 'System.Windows.Forms.ComboBox'
		$VCenterLabel = New-Object 'System.Windows.Forms.Label'
		$VcenterLoggingbox = New-Object 'System.Windows.Forms.RichTextBox'
	
	#Step 3
	$TemplateStep = New-Object 'System.Windows.Forms.TabPage'
		$TemplateDGV = New-Object 'System.Windows.Forms.DataGridView'
		$TemplateLabel = New-Object 'System.Windows.Forms.Label'
	
	
	#$Step4 = New-Object 'System.Windows.Forms.TabPage'
	#$datagridview2 = New-Object 'System.Windows.Forms.DataGridView'
	#$labelPleaseSelectTheInven = New-Object 'System.Windows.Forms.Label'
	#$Step5 = New-Object 'System.Windows.Forms.TabPage'
	#$combobox2 = New-Object 'System.Windows.Forms.ComboBox'
	#$labelPleaseSelectTheDesir = New-Object 'System.Windows.Forms.Label'
	#$Step6 = New-Object 'System.Windows.Forms.TabPage'
	#$datagridview3 = New-Object 'System.Windows.Forms.DataGridView'
	#$label1 = New-Object 'System.Windows.Forms.Label'
	#$Step7 = New-Object 'System.Windows.Forms.TabPage'
	#$datagridview4 = New-Object 'System.Windows.Forms.DataGridView'
	#$label2 = New-Object 'System.Windows.Forms.Label'

	$InitialFormWindowState = New-Object 'System.Windows.Forms.FormWindowState'
	
	#endregion

	#region Form Events
	
	$TemplateDGV_RowStateChanged = [System.Windows.Forms.DataGridViewRowStateChangedEventHandler]{
		#Event Argument: $_ = [System.Windows.Forms.DataGridViewRowStateChangedEventArgs]
		#TODO: Place custom script here
		
	}

	$VCenterComboBox_SelectedIndexChanged = {
		#Once the user has selected a VCenter server this will force the form to update.
		$buttonNext.Enabled = $true
	}
	
	$buttonBack_Click = {
		#Go to the previous tab page
		if ($tabcontrolWizard.SelectedIndex -gt 0)
		{
			$tabcontrolWizard.SelectedIndex--
		}
	}
	
	$buttonNext_Click = {
		#Go to the next tab page
		if ($tabcontrolWizard.SelectedIndex -lt $tabcontrolWizard.TabCount - 1)
		{
			$tabcontrolWizard.SelectedIndex++
		}
	}

	$buttonFinish_Click = {

	}
	
	$formWizard_Load={
		Update-NavButtons
	}
	
	$script:DeselectedIndex = -1
	$tabcontrolWizard_Deselecting=[System.Windows.Forms.TabControlCancelEventHandler]{
	#Event Argument: $_ = [System.Windows.Forms.TabControlCancelEventArgs]
		# Store the previous tab index
		$script:DeselectedIndex = $_.TabPageIndex
	}
	
	$tabcontrolWizard_Selecting=[System.Windows.Forms.TabControlCancelEventHandler]{
		
		#Event Argument: $_ = [System.Windows.Forms.TabControlCancelEventArgs]
		# We only validate if we are moving to the Next TabPage. 
		# Users can move back without validating
		
		if($script:DeselectedIndex -ne -1 -and $script:DeselectedIndex -lt $_.TabPageIndex)
		{
			#Validate each page until we reach the one we want
			for($index = $script:DeselectedIndex; $index -lt $_.TabPageIndex; $index++)
			{
				$_.Cancel = -not (Validate-WizardPage $tabcontrolWizard.TabPages[$index])
				
				if($_.Cancel) 
				{
					# Cancel and Return if validation failed.
					return;
				}
			}
		}
		
		Update-NavButtons
	}
	
	$Form_StateCorrection_Load ={
		#Correct the initial state of the form to prevent the .Net maximized form issue
		$formWizard.WindowState = $InitialFormWindowState
	}
	
	$Form_Cleanup_FormClosed ={
		#Remove all event handlers from the controls
		try
		{
			$buttonBack.remove_Click($buttonBack_Click)
			$buttonFinish.remove_Click($buttonFinish_Click)
			$VCenterComboBox.remove_SelectedIndexChanged($VCenterComboBox_SelectedIndexChanged)
			$VCenterLabel.remove_Click($VCenterLabel_Click)
			$TemplateDGV.remove_RowStateChanged($TemplateDGV_RowStateChanged)
			$TemplateLabel.remove_Click($TemplateLabel_Click)
			$labelPleaseSelectTheInven.remove_Click($labelPleaseSelectTheInven_Click)
			$tabcontrolWizard.remove_Selecting($tabcontrolWizard_Selecting)
			$tabcontrolWizard.remove_Deselecting($tabcontrolWizard_Deselecting)
			$buttonNext.remove_Click($buttonNext_Click)
			$formWizard.remove_Load($formWizard_Load)
			$formWizard.remove_Load($Form_StateCorrection_Load)
			$formWizard.remove_FormClosed($Form_Cleanup_FormClosed)
		}
		catch [Exception]
		{ }
	}
	
	#endregion
	
	#region FormWizard properties

	$formWizard.Controls.Add($buttonCancel)
	$formWizard.Controls.Add($buttonBack)
	$formWizard.Controls.Add($buttonFinish)
	$formWizard.Controls.Add($tabcontrolWizard)
	$formWizard.Controls.Add($buttonNext)
	$formWizard.AcceptButton = $buttonFinish
	$formWizard.CancelButton = $buttonCancel
	$formWizard.ClientSize = '706, 394'
	$formWizard.FormBorderStyle = 'FixedDialog'
	$formWizard.MaximizeBox = $False
	$formWizard.Name = 'formWizard'
	$formWizard.StartPosition = 'CenterScreen'
	$formWizard.Text = 'White & Case Server Build Tool'
	$formWizard.add_Load($formWizard_Load)
	
	#endregion
	
	#region Tab Control Wizard Properties
	
	$tabcontrolWizard.Controls.Add($WelcomeStep)
	$tabcontrolWizard.Controls.Add($VCenterStep)
	$tabcontrolWizard.Controls.Add($TemplateStep)
	#$tabcontrolWizard.Controls.Add($Step4)
	#$tabcontrolWizard.Controls.Add($Step5)
	#$tabcontrolWizard.Controls.Add($Step6)
	#$tabcontrolWizard.Controls.Add($Step7)
	$tabcontrolWizard.Anchor = 'Top, Bottom, Left, Right'
	$tabcontrolWizard.Location = '13, 12'
	$tabcontrolWizard.Name = 'Tab Control Wizard'
	$tabcontrolWizard.SelectedIndex = 0
	$tabcontrolWizard.Size = '681, 341'
	$tabcontrolWizard.TabIndex = 0
	$tabcontrolWizard.Visible = $True
	$tabcontrolWizard.add_Selecting($tabcontrolWizard_Selecting)
	$tabcontrolWizard.add_Deselecting($tabcontrolWizard_Deselecting)
	
	#endregion
	
	#region Form Buttons
	
	#region Cancel Button
	
	$buttonCancel.Anchor = 'Bottom, Right'
	$buttonCancel.DialogResult = 'Cancel'
	$buttonCancel.Location = '538, 359'
	$buttonCancel.Name = 'CancelButton'
	$buttonCancel.Size = '75, 23'
	$buttonCancel.TabIndex = 4
	$buttonCancel.Text = 'Cancel'
	$buttonCancel.UseVisualStyleBackColor = $True
	$buttonBack.add_Click($buttonCancel_Click)
	
	#endregion 
	
	#region Back Button
	
	$buttonBack.Anchor = 'Bottom, Left'
	$buttonBack.Location = '13, 359'
	$buttonBack.Name = 'BackButton'
	$buttonBack.Size = '75, 23'
	$buttonBack.TabIndex = 1
	$buttonBack.Text = '< &Back'
	$buttonBack.UseVisualStyleBackColor = $True
	$buttonBack.add_Click($buttonBack_Click)
	
	#endregion
	
	#region Finish Button
	
	$buttonFinish.Anchor = 'Bottom, Right'
	$buttonFinish.DialogResult = 'OK'
	$buttonFinish.Location = '619, 359'
	$buttonFinish.Name = 'FinishButton'
	$buttonFinish.Size = '75, 23'
	$buttonFinish.TabIndex = 3
	$buttonFinish.Text = 'Finish'
	$buttonFinish.UseVisualStyleBackColor = $True
	$buttonFinish.add_Click($buttonFinish_Click)
	
	#endregion
	
	#region Next Button
	
	$buttonNext.Anchor = 'Bottom, Right'
	$buttonNext.Location = '457, 359'
	$buttonNext.Name = 'NextButton'
	$buttonNext.Size = '75, 23'
	$buttonNext.TabIndex = 2
	$buttonNext.Text = 'Next >'
	$buttonNext.UseVisualStyleBackColor = $True
	$buttonNext.add_Click($buttonNext_Click)
	
	#endregion
	
	#endregion
	
	#region Welcome Step (Tab1)
	
	$WelcomeStep.Location = '4, 26'
	$WelcomeStep.Name = 'Step1'
	$WelcomeStep.Padding = '3, 3, 3, 3'
	$WelcomeStep.Size = '673, 311'
	$WelcomeStep.TabIndex = 0
	$WelcomeStep.Text = 'Welcome Screen'
	$WelcomeStep.UseVisualStyleBackColor = $True
	
	#endregion
	
	#region Welcome TextBox (Tab1)
	
	$WelcomeTextBox.Location = '3, 6'
	$WelcomeTextBox.Multiline = $True
	$WelcomeTextBox.Name = 'textbox1'
	$WelcomeTextBox.ReadOnly = $True
	$WelcomeTextBox.Size = '736, 419'
	$WelcomeTextBox.TabIndex = 0
	$WelcomeTextBox.Text = @"
Welcome to the White & Case Server build Tool.

The following Wizard will guide you through making the selections needed
to create a new VM from a template.

If you have any questions or feedback please contact :

phillip.marshall@whitecase.com
"@
	$WelcomeStep.Controls.Add($WelcomeTextBox)
	
	#endregion
	
	#region VCenter Server Selection (Tab2)
	
	$VCenterStep.Controls.Add($VCenterLabel)
	$VCenterStep.Location = '5, 26'
	$VCenterStep.Name = 'Step2'
	$VCenterStep.Padding = '3, 3, 3, 3'
	$VCenterStep.Size = '673, 311'
	$VCenterStep.TabIndex = 0
	$VCenterStep.Text = 'Select VCenter'
	$VCenterStep.UseVisualStyleBackColor = $True
	
	#endregion

	#region VCenter ComboBox (Tab2)

	$VCenterComboBox.FormattingEnabled = $True
	[void]$VCenterComboBox.Items.Add('AM1-Vcenter')
	[void]$VCenterComboBox.Items.Add('EM1-Vcenter')
	[void]$VCenterComboBox.Items.Add('AP1-VCenter')
	$VCenterComboBox.Location = '5, 33'
	$VCenterComboBox.Name = 'VCenterComboBox'
	$VCenterComboBox.Size = '169, 25'
	$VCenterComboBox.TabIndex = 0
	$VCenterComboBox.add_SelectedIndexChanged($VCenterComboBox_SelectedIndexChanged)
	$VCenterStep.Controls.Add($VCenterComboBox)
	
	#endregion
	
	#region VCenter ComboxBox Label (Tab2)

	$VCenterLabel.Location = '5, 7'
	$VCenterLabel.Name = 'Vcenter ComboBox Label'
	$VCenterLabel.Size = '250, 23'
	$VCenterLabel.TabIndex = 0
	$VCenterLabel.Text = 'Please select the VCenter Region.'
	
	#endregion
	
	#region VCenter LoggingBox (Tab2)
	
	$VcenterLoggingbox = New-Object 'System.Windows.Forms.RichTextBox'
	$VcenterLoggingbox.Location = New-Object System.Drawing.Size(0, 100)
	$VcenterLoggingbox.Size = New-Object System.Drawing.Point(650, 200)
	$VcenterLoggingbox.Name = "VCenter Box"
	$VcenterLoggingbox.TabIndex = 0
	$VcenterLoggingbox.Text = ""
	$VcenterLoggingbox.font = "Arial"
	$VcenterLoggingbox.BackColor = 'Gainsboro'
	$VCenterStep.Controls.Add($VcenterLoggingbox)
	
	#endregion
	
	#region Template Selection Step (Tab3)
	
	$TemplateStep.Location = '4, 26'
	$TemplateStep.Name = 'Step3'
	$TemplateStep.Size = '673, 311'
	$TemplateStep.TabIndex = 0
	$TemplateStep.Text = 'Select Template'
	$TemplateStep.UseVisualStyleBackColor = $True
	
	#endregion
	
	#region Template DataGridView (Tab3)
	
	$TemplateDGV.AllowUserToDeleteRows = $False
	$TemplateDGV.ColumnHeadersHeightSizeMode = 'AutoSize'
	$TemplateDGV.Location = '4, 68'
	$TemplateDGV.Name = 'TemplateDGV'
	$TemplateDGV.ReadOnly = $True
	$TemplateDGV.RowTemplate.Height = 24
	$TemplateDGV.Size = '650, 200'
	$TemplateDGV.TabIndex = 0
	$TemplateDGV.add_RowStateChanged($TemplateDGV_RowStateChanged)
	$TemplateStep.Controls.Add($TemplateDGV)
	
	#endregion
	
	#region Template DGV Label (Tab3)
	
	$TemplateLabel.Location = '3, 9'
	$TemplateLabel.Name = 'TemplateLabel'
	$TemplateLabel.Size = '414, 23'
	$TemplateLabel.TabIndex = 0
	$TemplateLabel.Text = 'Please select the template to deploy to the server.'
	$TemplateStep.Controls.Add($TemplateLabel)
	
	#endregion
	
	<#
	#################################################################
	$Step4.Controls.Add($datagridview2)
	$Step4.Controls.Add($labelPleaseSelectTheInven)
	$Step4.Location = '4, 26'
	$Step4.Name = 'Step4'
	$Step4.Padding = '3, 3, 3, 3'
	$Step4.Size = '673, 311'
	$Step4.TabIndex = 3
	$Step4.Text = 'Select Location'
	$Step4.UseVisualStyleBackColor = $True
	#######################################################
	$datagridview2.AllowUserToDeleteRows = $False
	$datagridview2.ColumnHeadersHeightSizeMode = 'AutoSize'
	$datagridview2.Location = '7, 60'
	$datagridview2.Name = 'datagridview2'
	$datagridview2.ReadOnly = $True
	$datagridview2.RowTemplate.Height = 24
	$datagridview2.Size = '240, 150'
	$datagridview2.TabIndex = 3
	#############################################################
	$labelPleaseSelectTheInven.Location = '7, 19'
	$labelPleaseSelectTheInven.Name = 'labelPleaseSelectTheInven'
	$labelPleaseSelectTheInven.Size = '396, 23'
	$labelPleaseSelectTheInven.TabIndex = 0
	$labelPleaseSelectTheInven.Text = 'Please select the Inventory Location from the options below.'
	$labelPleaseSelectTheInven.add_Click($labelPleaseSelectTheInven_Click)
	#############################################################
	$Step5.Controls.Add($combobox2)
	$Step5.Controls.Add($labelPleaseSelectTheDesir)
	$Step5.Location = '4, 26'
	$Step5.Name = 'Step5'
	$Step5.Padding = '3, 3, 3, 3'
	$Step5.Size = '673, 311'
	$Step5.TabIndex = 4
	$Step5.Text = 'Select ESX Host'
	$Step5.UseVisualStyleBackColor = $True
	##############################################################
	$combobox2.FormattingEnabled = $True
	$combobox2.Location = '6, 55'
	$combobox2.Name = 'combobox2'
	$combobox2.Size = '121, 25'
	$combobox2.TabIndex = 2
	###############################################################
	$labelPleaseSelectTheDesir.Location = '6, 18'
	$labelPleaseSelectTheDesir.Name = 'labelPleaseSelectTheDesir'
	$labelPleaseSelectTheDesir.Size = '396, 23'
	$labelPleaseSelectTheDesir.TabIndex = 1
	$labelPleaseSelectTheDesir.Text = 'Please select the Desired ESX host from the dropdown.'
	##############################################################
	$Step6.Controls.Add($datagridview3)
	$Step6.Controls.Add($label1)
	$Step6.Location = '4, 26'
	$Step6.Name = 'Step6'
	$Step6.Padding = '3, 3, 3, 3'
	$Step6.Size = '673, 311'
	$Step6.TabIndex = 5
	$Step6.Text = 'Select Storage Location'
	$Step6.UseVisualStyleBackColor = $True
	###############################################################
	$datagridview3.AllowUserToDeleteRows = $False
	$datagridview3.ColumnHeadersHeightSizeMode = 'AutoSize'
	$datagridview3.Location = '16, 73'
	$datagridview3.Name = 'datagridview3'
	$datagridview3.ReadOnly = $True
	$datagridview3.RowTemplate.Height = 24
	$datagridview3.Size = '240, 150'
	$datagridview3.TabIndex = 3
	################################################################
	$label1.Location = '3, 13'
	$label1.Name = 'label1'
	$label1.Size = '396, 23'
	$label1.TabIndex = 2
	$label1.Text = 'Please select the Desired storage location'
	################################################################
	$Step7.Controls.Add($datagridview4)
	$Step7.Controls.Add($label2)
	$Step7.Location = '4, 26'
	$Step7.Name = 'Step7'
	$Step7.Padding = '3, 3, 3, 3'
	$Step7.Size = '673, 311'
	$Step7.TabIndex = 6
	$Step7.Text = 'Select Customization'
	$Step7.UseVisualStyleBackColor = $True
	#################################################################
	$datagridview4.AllowUserToDeleteRows = $False
	$datagridview4.ColumnHeadersHeightSizeMode = 'AutoSize'
	$datagridview4.Location = '7, 59'
	$datagridview4.Name = 'datagridview4'
	$datagridview4.ReadOnly = $True
	$datagridview4.RowTemplate.Height = 24
	$datagridview4.Size = '240, 150'
	$datagridview4.TabIndex = 4
	##################################################################
	$label2.Location = '3, 12'
	$label2.Name = 'label2'
	$label2.Size = '396, 23'
	$label2.TabIndex = 3
	$label2.Text = 'Please select the Desired Customization.'
	##################################################################
	#>

	#Save the initial state of the form
	$InitialFormWindowState = $formWizard.WindowState
	#Init the OnLoad event to correct the initial state of the form
	$formWizard.add_Load($Form_StateCorrection_Load)
	#Clean up the control events
	$formWizard.add_FormClosed($Form_Cleanup_FormClosed)
	#Show the Form
	return $formWizard.ShowDialog()
	
}

Build-Form | Out-Null